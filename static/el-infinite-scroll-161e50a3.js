import{b1 as e,a2 as t}from"./index-af1b0f7f.js";import{t as n,g as l}from"./throttle-97af5aae.js";import{t as o}from"./event-15d81b97.js";import{g as i}from"./scroll-9ad6d206.js";const s="ElInfiniteScroll",c={delay:{type:Number,default:200},distance:{type:Number,default:0},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},r=(e,t)=>Object.entries(c).reduce(((n,[l,o])=>{var i,s;const{type:c,default:r}=o,a=e.getAttribute(`infinite-scroll-${l}`);let d=null!=(s=null!=(i=t[a])?i:a)?s:r;return d="false"!==d&&d,d=c(d),n[l]=Number.isNaN(d)?r:d,n}),{}),a=e=>{const{observer:t}=e[s];t&&(t.disconnect(),delete e[s].observer)},d=(e,t)=>{const{container:n,containerEl:o,instance:i,observer:c,lastScrollTop:a}=e[s],{disabled:d,distance:u}=r(e,i),{clientHeight:b,scrollHeight:m,scrollTop:f}=o,p=f-a;if(e[s].lastScrollTop=f,c||d||p<0)return;let v=!1;if(n===e)v=m-(b+f)<=u;else{const{clientTop:t,scrollHeight:n}=e;v=f+b>=l(e,o)+t+n-u}v&&t.call(i)};function u(e,t){const{containerEl:n,instance:l}=e[s],{disabled:o}=r(e,l);o||0===n.clientHeight||(n.scrollHeight<=n.clientHeight?t.call(l):a(e))}const b={async mounted(l,c){const{instance:a,value:b}=c;e(b)||o(s,"'v-infinite-scroll' binding value must be a function"),await t();const{delay:m,immediate:f}=r(l,a),p=i(l,!0),v=p===window?document.documentElement:p,g=n(d.bind(null,l,b),m);if(p){if(l[s]={instance:a,container:p,containerEl:v,delay:m,cb:b,onScroll:g,lastScrollTop:v.scrollTop},f){const e=new MutationObserver(n(u.bind(null,l,b),50));l[s].observer=e,e.observe(l,{childList:!0,subtree:!0}),u(l,b)}p.addEventListener("scroll",g)}},unmounted(e){const{container:t,onScroll:n}=e[s];null==t||t.removeEventListener("scroll",n),a(e)},async updated(e){if(e[s]){const{containerEl:t,cb:n,observer:l}=e[s];t.clientHeight&&l&&u(e,n)}else await t()},install:e=>{e.directive("InfiniteScroll",b)}},m=b;export{m as E};
