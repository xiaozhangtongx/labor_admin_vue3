import{b as e,g as a,_ as l,d as t,z as s,u as n,j as r,y as o,r as i,a as u,c as d,k as m,n as p,f as c,q as f,C as v,H as g,b7 as b,aN as h,K as _,p as j,F as y,ad as k,ag as x,Q as w,o as V,D as S,w as T,a4 as E,l as A,an as C}from"./index-1713f3be.js";import{v as O}from"./el-loading-14f9a8d4.js";import{E as M}from"./el-dialog-4ecabfaa.js";import"./el-overlay-7919f65d.js";import{a as q,E as H}from"./el-form-item-5a2ccd8a.js";/* empty css                 */import{_ as D}from"./index-0e9187b3.js";import{E as R}from"./el-input-number-ad4d11fb.js";import{E as F}from"./el-col-4b216b8c.js";import"./el-scrollbar-caee5b30.js";import"./el-popper-90370b12.js";import{a as U,E as z}from"./el-main-7a9f1d3d.js";import{E as I}from"./el-empty-e00cb9ee.js";import{E as N}from"./el-divider-9e3da786.js";/* empty css               *//* empty css                  */import{E as P}from"./el-card-020fefc8.js";import{E as G,a as K}from"./el-descriptions-item-910e224f.js";import{E as L}from"./el-button-1777eae9.js";import{_ as B,A as Q}from"./index.vue_vue_type_style_index_0_lang-ab24cd42.js";import{u as J,a as W,g as X,b as Y}from"./index-bead964b.js";/* empty css                 */import{E as Z}from"./index-0a4eee90.js";import{E as $}from"./index-152f0932.js";import{t as ee,u as ae,b as le,T as te,a as se,c as ne,d as re,e as oe,D as ie,C as ue}from"./panel-time-pick-6b9d5068.js";import{b as de}from"./_baseFlatten-7b946638.js";import{b as me,i as pe}from"./isArrayLikeObject-5ddbcf57.js";import{s as ce,S as fe,c as ve}from"./isEqual-5a787c40.js";import{S as ge}from"./_Uint8Array-85531e68.js";import{E as be}from"./index-3f18be1f.js";import"./focus-trap-6cc344c7.js";import"./event-15d81b97.js";import"./refs-0a43d458.js";import"./use-form-item-865a16c5.js";import"./scroll-e1940b97.js";import"./_initCloneObject-a49b3841.js";import"./el-tooltip-4ed993c7.js";import"./index-a3f93494.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./index-5c381d49.js";import"./debounce-1af7bc8d.js";import"./_overRest-efb82212.js";import"./index-d50292f6.js";function he(e){return e!=e}function _e(e,a){return!!(null==e?0:e.length)&&function(e,a,l){return a==a?function(e,a,l){for(var t=l-1,s=e.length;++t<s;)if(e[t]===a)return t;return-1}(e,a,l):function(e,a,l,t){for(var s=e.length,n=l+(t?1:-1);t?n--:++n<s;)if(a(e[n],n,e))return n;return-1}(e,he,l)}(e,a,0)>-1}function je(e,a,l){for(var t=-1,s=null==e?0:e.length;++t<s;)if(l(a,e[t]))return!0;return!1}const ye=ge&&1/ce(new ge([,-0]))[1]==1/0?function(e){return new ge(e)}:function(){};var ke=200;const xe=me((function(e){return function(e,a,l){var t=-1,s=_e,n=e.length,r=!0,o=[],i=o;if(l)r=!1,s=je;else if(n>=ke){var u=a?null:ye(e);if(u)return ce(u);r=!1,s=ve,i=new fe}else i=a?[]:o;e:for(;++t<n;){var d=e[t],m=a?a(d):d;if(d=l||0!==d?d:0,r&&m==m){for(var p=i.length;p--;)if(i[p]===m)continue e;a&&i.push(m),o.push(d)}else s(i,m,l)||(i!==o&&i.push(m),o.push(d))}return o}(de(e,1,pe,!0))})),we=e({...ee,parsedValue:{type:a(Array)}}),Ve=["disabled"];var Se=l(t({__name:"panel-time-range",props:we,emits:["pick","select-range","set-picker-option"],setup(e,{emit:a}){const l=e,t=(e,a)=>{const l=[];for(let t=e;t<=a;t++)l.push(t);return l},{t:j,lang:y}=s(),k=n("time"),x=n("picker"),w=r("EP_PICKER_BASE"),{arrowControl:V,disabledHours:S,disabledMinutes:T,disabledSeconds:E,defaultValue:A}=w.props,C=o((()=>l.parsedValue[0])),O=o((()=>l.parsedValue[1])),M=ae(l),q=o((()=>l.format.includes("ss"))),H=o((()=>l.format.includes("A")?"A":l.format.includes("a")?"a":"")),D=e=>{F(e.millisecond(0),O.value)},R=e=>{F(C.value,e.millisecond(0))},F=(e,l)=>{a("pick",[e,l],!0)},U=o((()=>C.value>O.value)),z=i([0,2]),I=(e,l)=>{a("select-range",e,l,"min"),z.value=[e,l]},N=o((()=>q.value?11:8)),P=(e,l)=>{a("select-range",e,l,"max");const t=c(N);z.value=[e+t,l+t]},G=(e,a)=>{const l=S?S(e):[],s="start"===e,n=(a||(s?O.value:C.value)).hour(),r=s?t(n+1,23):t(0,n-1);return xe(l,r)},K=(e,a,l)=>{const s=T?T(e,a):[],n="start"===a,r=l||(n?O.value:C.value);if(e!==r.hour())return s;const o=r.minute(),i=n?t(o+1,59):t(0,o-1);return xe(s,i)},L=(e,a,l,s)=>{const n=E?E(e,a,l):[],r="start"===l,o=s||(r?O.value:C.value),i=o.hour(),u=o.minute();if(e!==i||a!==u)return n;const d=o.second(),m=r?t(d+1,59):t(0,d-1);return xe(n,m)},B=([e,a])=>[Y(e,"start",!0,a),Y(a,"end",!1,e)],{getAvailableHours:Q,getAvailableMinutes:J,getAvailableSeconds:W}=le(G,K,L),{timePickerOptions:X,getAvailableTime:Y,onSetOption:Z}=se({getAvailableHours:Q,getAvailableMinutes:J,getAvailableSeconds:W});return a("set-picker-option",["formatToString",e=>e?h(e)?e.map((e=>e.format(l.format))):e.format(l.format):null]),a("set-picker-option",["parseUserInput",e=>e?h(e)?e.map((e=>b(e,l.format).locale(y.value))):b(e,l.format).locale(y.value):null]),a("set-picker-option",["isValidValue",e=>{const a=e.map((e=>b(e).locale(y.value))),l=B(a);return a[0].isSame(l[0])&&a[1].isSame(l[1])}]),a("set-picker-option",["handleKeydownInput",e=>{const a=e.code,{left:l,right:t,up:s,down:n}=_;if([l,t].includes(a)){return(e=>{const a=q.value?[0,3,6,11,14,17]:[0,3,8,11],l=["hours","minutes"].concat(q.value?["seconds"]:[]),t=(a.indexOf(z.value[0])+e+a.length)%a.length,s=a.length/2;t<s?X.start_emitSelectRange(l[t]):X.end_emitSelectRange(l[t-s])})(a===l?-1:1),void e.preventDefault()}if([s,n].includes(a)){const l=a===s?-1:1,t=z.value[0]<N.value?"start":"end";return X[`${t}_scrollDown`](l),void e.preventDefault()}}]),a("set-picker-option",["getDefaultValue",()=>{if(h(A))return A.map((e=>b(e).locale(y.value)));const e=b(A).locale(y.value);return[e,e.add(60,"m")]}]),a("set-picker-option",["getRangeAvailableTime",B]),(e,l)=>e.actualVisible?(u(),d("div",{key:0,class:p([c(k).b("range-picker"),c(x).b("panel")])},[m("div",{class:p(c(k).be("range-picker","content"))},[m("div",{class:p(c(k).be("range-picker","cell"))},[m("div",{class:p(c(k).be("range-picker","header"))},f(c(j)("el.datepicker.startTime")),3),m("div",{class:p([c(k).be("range-picker","body"),c(k).be("panel","content"),c(k).is("arrow",c(V)),{"has-seconds":c(q)}])},[v(te,{ref:"minSpinner",role:"start","show-seconds":c(q),"am-pm-mode":c(H),"arrow-control":c(V),"spinner-date":c(C),"disabled-hours":G,"disabled-minutes":K,"disabled-seconds":L,onChange:D,onSetOption:c(Z),onSelectRange:I},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),m("div",{class:p(c(k).be("range-picker","cell"))},[m("div",{class:p(c(k).be("range-picker","header"))},f(c(j)("el.datepicker.endTime")),3),m("div",{class:p([c(k).be("range-picker","body"),c(k).be("panel","content"),c(k).is("arrow",c(V)),{"has-seconds":c(q)}])},[v(te,{ref:"maxSpinner",role:"end","show-seconds":c(q),"am-pm-mode":c(H),"arrow-control":c(V),"spinner-date":c(O),"disabled-hours":G,"disabled-minutes":K,"disabled-seconds":L,onChange:R,onSetOption:c(Z),onSelectRange:P},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),m("div",{class:p(c(k).be("panel","footer"))},[m("button",{type:"button",class:p([c(k).be("panel","btn"),"cancel"]),onClick:l[0]||(l[0]=e=>{a("pick",M.value,!1)})},f(c(j)("el.datepicker.cancel")),3),m("button",{type:"button",class:p([c(k).be("panel","btn"),"confirm"]),disabled:c(U),onClick:l[1]||(l[1]=e=>((e=!1)=>{a("pick",[C.value,O.value],e)})())},f(c(j)("el.datepicker.confirm")),11,Ve)],2)],2)):g("v-if",!0)}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/time-picker/src/time-picker-com/panel-time-range.vue"]]);b.extend(ne);const Te=t({name:"ElTimePicker",install:null,props:{...re,isRange:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,a){const l=i(),[t,s]=e.isRange?["timerange",Se]:["time",oe],n=e=>a.emit("update:modelValue",e);return j("ElPopperOptions",e.popperOptions),a.expose({focus:e=>{var a;null==(a=l.value)||a.handleFocusInput(e)},blur:e=>{var a;null==(a=l.value)||a.handleBlurInput(e)},handleOpen:()=>{var e;null==(e=l.value)||e.handleOpen()},handleClose:()=>{var e;null==(e=l.value)||e.handleClose()}}),()=>{var a;const r=null!=(a=e.format)?a:ie;return v(ue,y(e,{ref:l,type:t,format:r,"onUpdate:modelValue":n}),{default:e=>v(s,e,null)})}}});Te.install=e=>{e.component(Te.name,Te)};const Ee=Te,Ae={class:"app-container"},Ce=m("span",{class:"i-mingcute-back-line"},null,-1),Oe=m("h4",{class:"text-center"}," 部门主管信息 ",-1),Me={class:"flex flex-col items-center justify-center max-h-400px overflow-hidden"},qe={class:"my-6"},He={class:"my-3"},De={class:"my-3"},Re=m("span",{class:"text-gray-500"},"-",-1),Fe=m("span",{class:"ml-2"},"小时（h）",-1),Ue=m("span",{class:"ml-2"},"千米（km）",-1),ze={class:"w-full h-200px standardMap"},Ie={class:"absolute bottom-0 z-9999 bg-light-50 m-0 p-0"},Ne=m("strong",null,"经度：",-1),Pe=m("strong",{class:"ml-3"}," 纬度：",-1),Ge=m("div",{id:"standardMap",class:"w-full h-full"},null,-1),Ke=t({__name:"index",setup(e){const a=k(),l=x(),t=i(),s=i(!1),n=i(null),r=i(null),o=i(!1),p=i(""),g=i("default"),b=i(null),h=i([116.397428,39.90923]),_=i(),j=w({id:"",deptId:a.query.id,lon:114.361595,lat:30.6078,earliestTime:"09:00:00",latestTime:"18:00:00",minDuration:9,des:"",radius:0}),y=w({radius:[{required:!0,message:"请输入打卡半径",trigger:"blur"}],minDuration:[{required:!0,message:"请输入最少工作时长",trigger:"blur"}],earliestTime:[{type:"string",required:!0,message:"请选择上班时间",trigger:"change"}],latestTime:[{type:"string",required:!0,message:"请选择下班时间",trigger:"change"}],des:[{message:"考勤标准备注",trigger:"blur"}]}),ee=()=>{const e=a.query.id;void 0===e?l.push("/403"):(s.value=!0,X(e).then((a=>{t.value=a.data,n.value=a.data.leader,Y(e).then((e=>{r.value=e.data}))})).catch((e=>{C.error(e.message)})).finally((()=>{s.value=!1})))},ae=e=>{null===e?p.value="制定考勤标准":(p.value="修改考勤标准",Object.assign(j,e)),o.value=!0,null!==j.lat&&null!==j.lon&&(h.value=[j.lon,j.lat]),Q.load({key:"b8fdf4fcb8c3449e4d3ef4e1a0172552",version:"2.0",plugins:["AMap.Geolocation","AMap.Geocoder"]}).then((e=>{var a;b.value=new e.Map("standardMap",{center:h.value,zoom:13});const l=new e.Marker({position:new e.LngLat(j.lon,j.lat),title:"打卡中心",draggable:!0});l.on("dragend",(e=>{j.lat=e.lnglat.lat,j.lon=e.lnglat.lng})),null==(a=b.value)||a.add(l),b.value.zoom=18}))};return V((()=>{ee()})),(e,a)=>{const i=G,b=L,h=K,k=P,x=Z,w=$,V=N,Q=U,X=I,Y=z,le=Ee,te=q,se=F,ne=R,re=D,oe=be,ie=H,ue=M,de=O;return S((u(),d("div",Ae,[v(k,{shadow:"never"},{default:T((()=>[v(h,{title:"部门信息",column:2},{default:T((()=>[v(i,{label:"部门名称:"},{default:T((()=>{var e;return[E(f(null==(e=t.value)?void 0:e.deptName),1)]})),_:1}),v(i,{label:"创建时间:"},{default:T((()=>{var e;return[E(f(null==(e=t.value)?void 0:e.createTime),1)]})),_:1}),v(i,{label:"部门职责:"},{default:T((()=>{var e;return[E(f(null==(e=t.value)?void 0:e.des),1)]})),_:1}),v(i,null,{default:T((()=>[v(b,{type:"success",onClick:a[0]||(a[0]=e=>c(l).push("/sys/dept"))},{default:T((()=>[Ce,E(" 返回上一页 ")])),_:1})])),_:1})])),_:1})])),_:1}),v(Y,{class:"flex justify-between mt-3"},{default:T((()=>[v(Q,{width:"30%"},{default:T((()=>[v(k,{class:"h-427px max-h-427px min-w-320px"},{default:T((()=>{var e,a,l;return[Oe,m("div",Me,[v(x,{size:130,src:null==(e=n.value)?void 0:e.avatar},null,8,["src"]),m("h3",qe,f(null==(a=n.value)?void 0:a.username),1),m("h3",He,[v(w,{class:"mr-2"},{default:T((()=>[E(" 管理部门 ")])),_:1}),v(V,{direction:"vertical"}),v(w,{class:"ml-2",type:"success"},{default:T((()=>[E(" 部门主管 ")])),_:1})]),m("h4",De," 联系方式： "+f(null==(l=n.value)?void 0:l.phoneNum),1)])]})),_:1})])),_:1}),v(Q,{width:"69%"},{default:T((()=>[null===r.value?(u(),A(k,{key:0,class:"h-427px max-h-427px min-w-730px"},{default:T((()=>[v(X,{description:"该部门暂时还没指定考勤标准"},{default:T((()=>[v(b,{type:"primary",onClick:a[1]||(a[1]=e=>ae(null))},{default:T((()=>[E(" 制定考勤标准 ")])),_:1})])),_:1})])),_:1})):(u(),A(k,{key:1,class:"h-427px max-h-427px min-w-730px"},{default:T((()=>{var e,l;return[v(h,{title:"部门考勤标准",column:3},{default:T((()=>[v(i,{label:"迟到时间:"},{default:T((()=>{var e;return[E(f(null==(e=r.value)?void 0:e.earliestTime),1)]})),_:1}),v(i,{label:"早退时间:"},{default:T((()=>{var e;return[E(f(null==(e=r.value)?void 0:e.latestTime),1)]})),_:1}),v(i,null,{default:T((()=>[v(b,{type:"primary",onClick:a[2]||(a[2]=e=>ae(r.value))},{default:T((()=>[E(" 更换考勤标准 ")])),_:1})])),_:1})])),_:1}),v(B,{lng:null==(e=r.value)?void 0:e.lon,lat:null==(l=r.value)?void 0:l.lat},null,8,["lng","lat"])]})),_:1}))])),_:1})])),_:1}),v(ue,{modelValue:o.value,"onUpdate:modelValue":a[10]||(a[10]=e=>o.value=e),title:p.value,width:"37%","destroy-on-close":"",draggable:"","align-center":"",class:"min-w-370px"},{default:T((()=>[v(ie,{ref_key:"ruleFormRef",ref:_,model:j,rules:y,"label-width":"120px",class:"demo-ruleForm",size:g.value,"status-icon":"","label-position":"left"},{default:T((()=>[v(te,{label:"考勤时间段",required:""},{default:T((()=>[v(se,{span:11},{default:T((()=>[v(te,{prop:"earliestTime"},{default:T((()=>[v(le,{modelValue:j.earliestTime,"onUpdate:modelValue":a[3]||(a[3]=e=>j.earliestTime=e),type:"date",label:"上班时间",placeholder:"请选择上班时间","value-format":"HH:mm:ss",format:"HH:mm:ss",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),v(se,{class:"text-center",span:2},{default:T((()=>[Re])),_:1}),v(se,{span:11},{default:T((()=>[v(te,{prop:"latestTime"},{default:T((()=>[v(le,{modelValue:j.latestTime,"onUpdate:modelValue":a[4]||(a[4]=e=>j.latestTime=e),label:"请选择下班时间",placeholder:"请选择下班时间","value-format":"HH:mm:ss",format:"HH:mm:ss",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),v(te,{label:"最少工作时长",prop:"minDuration",required:""},{default:T((()=>[v(ne,{modelValue:j.minDuration,"onUpdate:modelValue":a[5]||(a[5]=e=>j.minDuration=e),min:6,max:12,"controls-position":"right"},null,8,["modelValue"]),Fe])),_:1}),v(te,{label:"打卡半径",prop:"radius",required:""},{default:T((()=>[v(ne,{modelValue:j.radius,"onUpdate:modelValue":a[6]||(a[6]=e=>j.radius=e),min:.3,max:5,precision:2,step:.1,"controls-position":"right"},null,8,["modelValue","min","step"]),Ue])),_:1}),v(te,{label:"打卡坐标中心点",required:""},{default:T((()=>[m("div",ze,[m("p",Ie,[Ne,E(f(j.lon||"还未打卡")+" ",1),Pe,E(" "+f(j.lat||"还未打卡"),1)]),Ge]),v(re,{element:".standardMap","open-tips":"地图全屏",class:"absolute right-0 top-0"})])),_:1}),v(te,{label:"考勤标准描述",prop:"des"},{default:T((()=>[v(oe,{modelValue:j.des,"onUpdate:modelValue":a[7]||(a[7]=e=>j.des=e),type:"textarea",maxlength:"100",placeholder:"请输入考勤标准描述","show-word-limit":""},null,8,["modelValue"])])),_:1}),v(te,null,{default:T((()=>[v(b,{type:"primary",onClick:a[8]||(a[8]=e=>(async e=>{e&&await e.validate(((a,l)=>{a?""!==j.id?J(j).then((e=>{ee(),C.success(e.msg)})).finally((()=>{o.value=!1,e.resetFields()})):W(j).then((e=>{ee(),C.success(e.msg)})).finally((()=>{o.value=!1,e.resetFields()})):C.error(l)}))})(_.value))},{default:T((()=>[E(" 提交 ")])),_:1}),v(b,{onClick:a[9]||(a[9]=e=>{var a;(a=_.value)&&a.resetFields()})},{default:T((()=>[E(" 重置 ")])),_:1})])),_:1})])),_:1},8,["model","rules","size"])])),_:1},8,["modelValue","title"])])),[[de,s.value]])}}});export{Ke as default};
